<template>
  <div class="min-h-screen px-6 pt-6 pb-24 bg-white text-gray-900">

    <!-- Tombol Kembali -->
    <button @click="$router.back()" class="text-sm text-gray-700 mb-4">
      â€¹ Kembali
    </button>

    <!-- Judul + Sisa Dana -->
    <h1 class="text-2xl font-bold text-gray-900">Kelola Anggaran Bulananmu</h1>
    <p class="text-green-600 font-bold text-base mt-2">Sisa Dana : Rp {{ formatNumber(sisaDana) }}</p>

    <!-- Large remaining progress bar (matches design) -->
    <div class="mt-4">
      <ProgressBar :percent="remainingPercent" :height="18" fillColor="#059669" trackColor="#e6eef2" />
    </div>

    <!-- Ringkasan Anggaran -->
    <div class="mt-5 bg-white p-4 rounded-xl shadow-sm border border-gray-200">
      <div class="flex justify-between mb-1 text-sm">
        <span class="font-medium text-gray-700">Total Anggaran</span>
        <span class="font-semibold text-gray-900">Rp {{ formatNumber(totalAnggaran) }}</span>
      </div>

      <div class="flex justify-between mb-1 text-sm">
        <span class="font-medium text-gray-700">Total Terpakai</span>
        <span class="font-semibold text-red-600">Rp {{ formatNumber(totalTerpakai) }}</span>
      </div>

      <p class="text-xs text-gray-500 mt-1">Pemakaian anggaran: {{ Math.round(persentase) }}%</p>
    </div>

    <!-- Kategori Pengeluaran -->
    <h2 class="text-lg font-semibold mt-8 mb-3 text-gray-900">Kategori Pengeluaran</h2>

    <div v-for="item in listKategori" :key="item.nama" class="bg-white p-4 rounded-xl shadow-sm border border-gray-200 mb-4">
      <div class="flex justify-between mb-1 text-sm">
        <span class="font-medium text-gray-700">{{ item.nama }}</span>
        <span class="font-semibold text-gray-900">Rp {{ formatNumber(item.terpakai) }} / Rp {{ formatNumber(item.total) }}</span>
      </div>

      <div class="flex items-center justify-between gap-3">
        <div class="flex-1">
          <ProgressBar :percent="(item.terpakai / item.total) * 100" :height="8" fillColor="#059669" trackColor="#eef2f3" />
        </div>
        <div class="w-16 text-right text-xs text-gray-600">
          {{ Math.round((item.terpakai / item.total) * 100) }}%
        </div>
      </div>
    </div>

    <!-- Bottom Navigation -->
    <BottomNav class="bg-white text-gray-900" />
  </div>
</template>

<script>
import BottomNav from "../../components/BottomNav.vue";
import ProgressBar from "../../components/ProgressBar.vue";

export default {
  components: { BottomNav, ProgressBar },

  data() {
    return {
      listKategori: [
        { nama: "Makan", terpakai: 150000, total: 200000 },
        { nama: "Transportasi", terpakai: 100000, total: 200000 },
        { nama: "Hiburan", terpakai: 40000, total: 100000 }
      ]
    };
  },

  computed: {
    totalAnggaran() {
      return this.listKategori.reduce((t, k) => t + k.total, 0);
    },
    totalTerpakai() {
      return this.listKategori.reduce((t, k) => t + k.terpakai, 0);
    },
    sisaDana() {
      return this.totalAnggaran - this.totalTerpakai;
    },
    persentase() {
      return (this.totalTerpakai / this.totalAnggaran) * 100;
    },
    remainingPercent() {
      if (!this.totalAnggaran) return 0;
      return (this.sisaDana / this.totalAnggaran) * 100;
    }
  },

  methods: {
    formatNumber(num) {
      return num.toLocaleString("id-ID");
    }
  }
};
</script>
